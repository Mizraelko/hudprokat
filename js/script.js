"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".popup__link");let t=!0;if(e.length>0)for(let t=0;t<e.length;t++){const n=e[t];n.addEventListener("click",e=>{const t=n.getAttribute("href").replace("#","");o(document.getElementById(t)),e.preventDefault()})}const n=document.querySelectorAll(".close__popup");if(n.length>0)for(let t=0;t<e.length;t++){const e=n[t]||n[0];e.addEventListener("click",t=>{c(e.closest(".popup")),t.preventDefault()})}function o(e){if(e&&t){const t=document.querySelector(".popup.open");t&&c(t),e.classList.add("open"),e.addEventListener("click",e=>{e.target.closest(".popup__body")||c(e.target.closest(".popup"))})}}function c(e){t&&e.classList.remove("open")}document.addEventListener("keydown",e=>{if(27===e.keyCode){c(document.querySelector(".popup.open"))}});const r=document.getElementById("tel_modal");let i;function a(e){e.keyCode&&(i=e.keyCode),this.selectionStart<3&&e.preventDefault();let t="+7 (___) ___-__-__",n=0,o=t.replace(/\D/g,""),c=this.value.replace(/\D/g,""),r=t.replace(/[_\d]/g,function(e){return n<c.length?c.charAt(n++)||o.charAt(n):e});-1!=(n=r.indexOf("_"))&&(n<5&&(n=3),r=r.slice(0,n));let a=t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(a=new RegExp("^"+a+"$")).test(this.value)||this.value.length<5||i>47&&i<58)&&(this.value=r),"blur"==e.type&&this.value.length<5&&(this.value="")}r.addEventListener("input",a,!1),r.addEventListener("focus",a,!1),r.addEventListener("blur",a,!1),r.addEventListener("keydown",a,!1);const l=document.getElementById("form"),s=document.getElementById("popup");l.addEventListener("submit",async function(e){e.preventDefault();let t=document.createElement("script");t.setAttribute("captcha","true"),t.src="https://www.google.com/recaptcha/api.js?render=6LeXL70aAAAAACiCuzocHUD192yTV6OFHHWUGVwS",t.async=!1,document.body.appendChild(t),setTimeout(()=>{grecaptcha.ready(function(){grecaptcha.execute("6LeXL70aAAAAACiCuzocHUD192yTV6OFHHWUGVwS",{action:"homepage"}).then(function(e){let n=function(e){let t=0,n=document.querySelectorAll(".__req");for(let e=0;e<n.length;e++){const r=n[e];return c(r),"checkbox"===r.getAttribute("type")&&!1===r.checked?(o(r),t++):""===r.value&&(o(r),t++),t}function o(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function c(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}}(),o="";o=e,document.getElementById("token").value=e;let c=new FormData(l);c.append("token",e),fetch("../contacts.php",{method:"POST",body:c}).then(e=>e.json()).then(e=>{if(e.om_score>=.5){let e=new FormData(l);e.append("image",d.files[0]),0===n?(l.classList.add("_sending"),fetch("../contacts.php",{method:"POST",body:e}).then(e=>{e.ok?(u.innerHTML="",l.reset(),l.classList.remove("_sending"),setTimeout(()=>{alert("Спасибо.Ваше сообщение успешно отправленно."),s.classList.remove("open"),document.body.removeChild(t)},1e3)):(l.classList.remove("_sending"),setTimeout(()=>{s.classList.remove("open");const e=document.body.querySelector("script[captcha]");document.body.removeChild(e),alert("Ooops,ошибочка вышла")},1e3))})):alert("Заполните обязательные поля")}else console.log("Бот")})})})},100)});const d=document.getElementById("file"),u=document.getElementById("formPreview");if(!window.location.href.includes("contact")){d.addEventListener("change",()=>{!function(e){if(!["image/jpeg","image/png","image/gif"].includes(e.type))return alert("Разрешены только изображения."),void(d.value="");if(e.size>2097152)return void alert("Файл должен быть не более 2 МБ.");let t=new FileReader;t.onload=function(e){u.innerHTML=`<img src="${e.target.result}" alt="фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}(d.files[0])})}const m=document.querySelector(".tabs"),p=document.querySelectorAll(".links__item"),g=document.querySelectorAll(".tab-content");m&&m.addEventListener("click",e=>{if(e.target.classList.contains("links__item")){const t=e.target.dataset.tabsPath;p.forEach(e=>{e.classList.remove("links__item_active")}),document.querySelector(`[data-tabs-path="${t}"]`).classList.add("links__item_active"),v(t)}});const v=e=>{g.forEach(e=>{e.classList.remove("tab__content_active")}),document.querySelector(`[data-tabs-target="${e}"]`).classList.add("tab__content_active")},_={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},IOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return _.Android()||_.BlackBerry()||_.IOS()||_.Opera()||_.Windows()}};if(_.any()){document.body.classList.add("_touch"),[...document.querySelectorAll(".menu__arrow-container")].map(e=>{e.addEventListener("click",e=>{let t=e.target.closest(".menu__arrow-container");t.parentElement.classList.toggle("_active");const n=[...document.querySelectorAll(".menu__list > li._active")];n.length>0?n.map(e=>{e.classList.remove("_active"),t.parentElement.classList.add("_active")}):t.parentElement.classList.add("_active"),0==n.length&&t.parentElement.classList.toggle("_active")})})}else document.body.classList.add("_pc");const f=document.querySelector(".menu__icon-container"),y=document.querySelector(".menu__body"),h=document.querySelector(".menu__icon");h&&f.addEventListener("click",e=>{document.body.classList.toggle("_lock"),h.classList.toggle("_active"),y.classList.toggle("_active")});const L=document.querySelector(".menu__link[data-goto]");L&&L.addEventListener("click",e=>{if(L.dataset.goto&&document.querySelector(L.dataset.goto)){const t=document.querySelector(L.dataset.goto).getBoundingClientRect().top+pageYOffset;h.classList.contains("_active")&&(document.body.classList.remove("_lock"),h.classList.remove("_active"),y.classList.remove("_active")),window.scrollTo({top:t,behavior:"smooth"}),e.preventDefault()}});let b=document.querySelector(".map"),E={once:!0,passive:!0,capture:!0};b.addEventListener("click",w,E),b.addEventListener("mouseover",w,E),b.addEventListener("touchstart",w,E),b.addEventListener("touchmove",w,E);let A=!1;function w(){if(!A){let e=document.getElementById("map_lazy");A=!0,e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")}}});const container=[...document.querySelectorAll(".grid__list")],element="grid__item",elementHover="grid__description",animationDuration=300;let currentElement=null;function findDirection(e,t,n){let o=e.getBoundingClientRect(),c=Math.abs(o.left-t.clientX),r=Math.abs(o.right-t.clientX),i=Math.abs(o.top-t.clientY),a=Math.abs(o.bottom-t.clientY),l=null;switch(Math.min(c,r,i,a)){case c:l=n+"Left";break;case r:l=n+"Right";break;case i:l=n+"Top";break;case a:l=n+"Bottom"}e.querySelector(`.${elementHover}`).classList=`${elementHover} ${l}`}container.map(e=>{e.addEventListener("mouseover",function(t){if(currentElement)return;let n=t.target.closest(".grid__item");n&&e.contains(n)&&findDirection(currentElement=n,t,"from")}),e.addEventListener("mouseout",function(e){if(!currentElement)return;let t=e.relatedTarget;for(;t;){if(t==currentElement)return;t=t.parentNode}findDirection(currentElement,e,"to"),currentElement=null})});const arrowTop=document.querySelector(".arrow-top"),callMe=document.querySelector(".call-me");function visibleButton(){window.pageYOffset>600?arrowTop.style.visibility="visible":arrowTop.style.visibility="hidden",window.pageYOffset>600?callMe.style.visibility="visible":callMe.style.visibility="hidden",arrowTop.addEventListener("click",e=>{window.scrollTo({top:0,behavior:"smooth"}),e.preventDefault()})}window.addEventListener("scroll",visibleButton);const lazy=[...document.querySelectorAll("img")];lazy.map(e=>{e.setAttribute("loading","lazy")});