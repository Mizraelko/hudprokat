"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".popup__link");document.querySelector("body");let t=!0;if(e.length>0)for(let t=0;t<e.length;t++){const n=e[t];n.addEventListener("click",e=>{const t=n.getAttribute("href").replace("#","");o(document.getElementById(t)),e.preventDefault()})}const n=document.querySelectorAll(".close__popup");if(n.length>0)for(let t=0;t<e.length;t++){const e=n[t]||n[0];e.addEventListener("click",t=>{r(e.closest(".popup")),t.preventDefault()})}function o(e){if(e&&t){const t=document.querySelector(".popup.open");t&&r(t),e.classList.add("open"),e.addEventListener("click",e=>{e.target.closest(".popup__body")||r(e.target.closest(".popup"))})}}function r(e){t&&e.classList.remove("open")}document.addEventListener("keydown",e=>{if(27===e.keyCode){r(document.querySelector(".popup.open"))}});const i=document.getElementById("tel_modal");let c;function a(e){e.keyCode&&(c=e.keyCode),this.selectionStart<3&&e.preventDefault();let t="+7 (___) ___-__-__",n=0,o=t.replace(/\D/g,""),r=this.value.replace(/\D/g,""),i=t.replace(/[_\d]/g,function(e){return n<r.length?r.charAt(n++)||o.charAt(n):e});-1!=(n=i.indexOf("_"))&&(n<5&&(n=3),i=i.slice(0,n));let a=t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(a=new RegExp("^"+a+"$")).test(this.value)||this.value.length<5||c>47&&c<58)&&(this.value=i),"blur"==e.type&&this.value.length<5&&(this.value="")}i.addEventListener("input",a,!1),i.addEventListener("focus",a,!1),i.addEventListener("blur",a,!1),i.addEventListener("keydown",a,!1);const l=document.getElementById("form"),s=document.getElementById("popup");l.addEventListener("submit",async function(e){e.preventDefault();let t=function(e){let t=0,n=document.querySelectorAll(".__req");for(let e=0;e<n.length;e++){const i=n[e];return r(i),"checkbox"===i.getAttribute("type")&&!1===i.checked?(o(i),t++):""===i.value&&(o(i),t++),t}function o(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function r(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}}(),n=new FormData(l);if(n.append("image",d.files[0]),0===t){l.classList.add("_sending");let e=await fetch("../contacts.php",{method:"POST",body:n});e.ok?(u.innerHTML="",l.reset(),l.classList.remove("_sending"),setTimeout(()=>{s.classList.remove("open"),alert("Спасибо.Ваше сообщение успешно отправленно.")},1e3)):(l.classList.remove("_sending"),setTimeout(()=>{s.classList.remove("open"),alert("Ooops,ошибочка вышла")},1e3))}else alert("Заполните обязательные поля")});const d=document.getElementById("file"),u=document.getElementById("formPreview");if(!window.location.href.includes("contact")){d.addEventListener("change",()=>{!function(e){if(!["image/jpeg","image/png","image/gif"].includes(e.type))return alert("Разрешены только изображения."),void(d.value="");if(e.size>2097152)return void alert("Файл должен быть не более 2 МБ.");let t=new FileReader;t.onload=function(e){u.innerHTML=`<img src="${e.target.result}" alt="фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}(d.files[0])})}const m=document.querySelector(".tabs"),v=document.querySelectorAll(".links__item"),g=document.querySelectorAll(".tab-content");m&&m.addEventListener("click",e=>{if(e.target.classList.contains("links__item")){const t=e.target.dataset.tabsPath;v.forEach(e=>{e.classList.remove("links__item_active")}),document.querySelector(`[data-tabs-path="${t}"]`).classList.add("links__item_active"),p(t)}});const p=e=>{g.forEach(e=>{e.classList.remove("tab__content_active")}),document.querySelector(`[data-tabs-target="${e}"]`).classList.add("tab__content_active")},_={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},IOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return _.Android()||_.BlackBerry()||_.IOS()||_.Opera()||_.Windows()}};if(_.any()){document.body.classList.add("_touch"),[...document.querySelectorAll(".menu__arrow-container")].map(e=>{e.addEventListener("click",e=>{let t=e.target.closest(".menu__arrow-container");t.parentElement.classList.toggle("_active");const n=[...document.querySelectorAll(".menu__list > li._active")];n.length>0?n.map(e=>{e.classList.remove("_active"),t.parentElement.classList.add("_active")}):t.parentElement.classList.add("_active"),0==n.length&&t.parentElement.classList.toggle("_active")})})}else document.body.classList.add("_pc");const f=document.querySelector(".menu__icon-container"),y=document.querySelector(".menu__body"),L=document.querySelector(".menu__icon");L&&f.addEventListener("click",e=>{document.body.classList.toggle("_lock"),L.classList.toggle("_active"),y.classList.toggle("_active")});const h=document.querySelector(".menu__link[data-goto]");h&&h.addEventListener("click",e=>{if(h.dataset.goto&&document.querySelector(h.dataset.goto)){const t=document.querySelector(h.dataset.goto).getBoundingClientRect().top+pageYOffset;L.classList.contains("_active")&&(document.body.classList.remove("_lock"),L.classList.remove("_active"),y.classList.remove("_active")),window.scrollTo({top:t,behavior:"smooth"}),e.preventDefault()}});let E=document.querySelector(".map"),b={once:!0,passive:!0,capture:!0};E.addEventListener("click",w,b),E.addEventListener("mouseover",w,b),E.addEventListener("touchstart",w,b),E.addEventListener("touchmove",w,b);let k=!1;function w(){if(!k){let e=document.getElementById("map_lazy");k=!0,e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")}}});const container=[...document.querySelectorAll(".grid__list")],element="grid__item",elementHover="grid__description",animationDuration=300;let currentElement=null;function findDirection(e,t,n){let o=e.getBoundingClientRect(),r=Math.abs(o.left-t.clientX),i=Math.abs(o.right-t.clientX),c=Math.abs(o.top-t.clientY),a=Math.abs(o.bottom-t.clientY),l=null;switch(Math.min(r,i,c,a)){case r:l=n+"Left";break;case i:l=n+"Right";break;case c:l=n+"Top";break;case a:l=n+"Bottom"}e.querySelector(`.${elementHover}`).classList=`${elementHover} ${l}`}container.map(e=>{e.addEventListener("mouseover",function(t){if(currentElement)return;let n=t.target.closest(".grid__item");n&&e.contains(n)&&findDirection(currentElement=n,t,"from")}),e.addEventListener("mouseout",function(e){if(!currentElement)return;let t=e.relatedTarget;for(;t;){if(t==currentElement)return;t=t.parentNode}findDirection(currentElement,e,"to"),currentElement=null})});const arrowTop=document.querySelector(".arrow-top"),callMe=document.querySelector(".call-me");function visibleButton(){window.pageYOffset>600?arrowTop.style.visibility="visible":arrowTop.style.visibility="hidden",window.pageYOffset>600?callMe.style.visibility="visible":callMe.style.visibility="hidden",arrowTop.addEventListener("click",e=>{window.scrollTo({top:0,behavior:"smooth"}),e.preventDefault()})}window.addEventListener("scroll",visibleButton);const lazy=[...document.querySelectorAll("img")];lazy.map(e=>{e.setAttribute("loading","lazy")});